import { ToolBase } from '../core/ToolBase.js';

class EStatHelpTool extends ToolBase {
  constructor() {
    super();
    this.name = 'e_stat_help';
  }

  getSchema() {
    return {
      name: 'e_stat_help',
      description: 'e-Stat MCPã‚µãƒ¼ãƒãƒ¼ã®ä½¿ã„æ–¹ã¨ãƒ„ãƒ¼ãƒ«ã®è©³ç´°èª¬æ˜Žã‚’è¡¨ç¤ºã—ã¾ã™',
      inputSchema: {
        type: 'object',
        properties: {
          topic: {
            type: 'string',
            description: 'ãƒ˜ãƒ«ãƒ—ãƒˆãƒ”ãƒƒã‚¯',
            enum: [
              'overview',      // æ¦‚è¦
              'workflow',      // åŸºæœ¬ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼  
              'search',        // æ¤œç´¢æ©Ÿèƒ½
              'data',          // ãƒ‡ãƒ¼ã‚¿å–å¾—
              'meta',          // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
              'download',      // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
              'debug',         // ãƒ‡ãƒãƒƒã‚°
              'examples',      // ä½¿ç”¨ä¾‹
              'parameters',    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è©³ç´°
              'troubleshooting' // ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
            ],
            default: 'overview'
          },
          format: {
            type: 'string',
            description: 'å‡ºåŠ›å½¢å¼',
            enum: ['text', 'markdown'],
            default: 'text'
          }
        }
      }
    };
  }

  async execute(args) {
    try {
      const topic = args.topic || 'overview';
      const format = args.format || 'text';
      
      const helpContent = this.getHelpContent(topic);
      
      return this.formatResponse({
        topic,
        content: helpContent,
        format,
        timestamp: new Date().toISOString()
      }, {
        tool: this.name,
        version: '1.0.0'
      });
    } catch (error) {
      return this.formatResponse({
        error: error.message,
        success: false
      });
    }
  }

  getHelpContent(topic) {
    const helpTopics = {
      overview: this.getOverview(),
      workflow: this.getWorkflow(),
      search: this.getSearchHelp(),
      data: this.getDataHelp(),
      meta: this.getMetaHelp(),
      download: this.getDownloadHelp(),
      debug: this.getDebugHelp(),
      examples: this.getExamples(),
      parameters: this.getParameters(),
      troubleshooting: this.getTroubleshooting()
    };

    return helpTopics[topic] || helpTopics.overview;
  }

  getOverview() {
    return `
ðŸ“Š e-Stat MCPã‚µãƒ¼ãƒãƒ¼ ãƒ˜ãƒ«ãƒ—

ã“ã®MCPã‚µãƒ¼ãƒãƒ¼ã¯æ—¥æœ¬æ”¿åºœçµ±è¨ˆã®ç·åˆçª“å£ã€Œe-Statã€APIã‚’æ´»ç”¨ã—ã¦ã€
Claudeã‹ã‚‰ç›´æŽ¥çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã§ã™ã€‚

ðŸ› ï¸ åˆ©ç”¨å¯èƒ½ãªãƒ„ãƒ¼ãƒ«:
â€¢ e_stat_search     - çµ±è¨ˆãƒ‡ãƒ¼ã‚¿æ¤œç´¢
â€¢ e_stat_get_data   - çµ±è¨ˆãƒ‡ãƒ¼ã‚¿å–å¾—
â€¢ e_stat_get_meta   - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—
â€¢ e_stat_download   - ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
â€¢ e_stat_debug      - æŽ¥ç¶šãƒ»å‹•ä½œç¢ºèª
â€¢ e_stat_help       - ã“ã®ãƒ˜ãƒ«ãƒ—

ðŸ’¡ åŸºæœ¬çš„ãªä½¿ã„æ–¹:
1. e_stat_search ã§çµ±è¨ˆè¡¨ã‚’æ¤œç´¢
2. e_stat_get_meta ã§ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ç¢ºèª
3. e_stat_get_data ã§å®Ÿãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

è©³ç´°ã¯å„ãƒˆãƒ”ãƒƒã‚¯ã‚’ã”ç¢ºèªãã ã•ã„:
- workflow: åŸºæœ¬ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- examples: å®Ÿç”¨çš„ãªä½¿ç”¨ä¾‹
- troubleshooting: ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
    `;
  }

  getWorkflow() {
    return `
ðŸ”„ e-Stat API åŸºæœ¬ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

ã€ã‚¹ãƒ†ãƒƒãƒ—1: çµ±è¨ˆè¡¨ã®æ¤œç´¢ã€‘
e_stat_search ã‚’ä½¿ç”¨ã—ã¦ç›®çš„ã®çµ±è¨ˆè¡¨ã‚’è¦‹ã¤ã‘ã¾ã™ã€‚

ä¾‹: äººå£çµ±è¨ˆã‚’æ¤œç´¢
{
  "searchWord": "äººå£",
  "statsCode": "00200521",  // å›½å‹¢èª¿æŸ»
  "limit": 10
}

ã€ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèªã€‘
e_stat_get_meta ã§çµ±è¨ˆè¡¨ã®æ§‹é€ ã‚’ç†è§£ã—ã¾ã™ã€‚

ä¾‹: çµ±è¨ˆè¡¨ã®è©³ç´°æƒ…å ±ã‚’å–å¾—
{
  "dataSetId": "0003448237"
}

ã€ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã€‘
e_stat_get_data ã§å®Ÿéš›ã®æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚

ä¾‹: æ±äº¬éƒ½ã®äººå£ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
{
  "dataSetId": "0003448237",
  "cdArea": "13000",        // æ±äº¬éƒ½
  "cdTime": "2020000000",   // 2020å¹´
  "limit": 500
}

ðŸ’¡ åŠ¹çŽ‡çš„ãªãƒ‡ãƒ¼ã‚¿å–å¾—ã®ã‚³ãƒ„:
â€¢ æœ€åˆã¯å°ã•ãªlimitå€¤ã§ãƒ†ã‚¹ãƒˆ
â€¢ åœ°åŸŸã‚„æ™‚é–“è»¸ã§çµžã‚Šè¾¼ã‚“ã§ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
â€¢ å¤§é‡ãƒ‡ãƒ¼ã‚¿ã¯è‡ªå‹•çš„ã«ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ã•ã‚Œã‚‹
    `;
  }

  getSearchHelp() {
    return `
ðŸ” e_stat_search - çµ±è¨ˆãƒ‡ãƒ¼ã‚¿æ¤œç´¢

ã€åŸºæœ¬çš„ãªä½¿ã„æ–¹ã€‘
çµ±è¨ˆè¡¨ã‚’æ¤œç´¢ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆIDã‚’ç‰¹å®šã—ã¾ã™ã€‚

ã€ä¸»è¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ searchWord: æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ (ä¾‹: "äººå£", "åŠ´åƒåŠ›")
â€¢ statsCode: æ”¿åºœçµ±è¨ˆã‚³ãƒ¼ãƒ‰ (ä¾‹: "00200521"=å›½å‹¢èª¿æŸ»)
â€¢ statsField: çµ±è¨ˆåˆ†é‡Ž (ä¾‹: "02"=äººå£ãƒ»ä¸–å¸¯)
â€¢ collectArea: åœ°åŸŸåŒºåˆ† ("1"=å…¨å›½, "2"=éƒ½é“åºœçœŒ, "3"=å¸‚åŒºç”ºæ‘)
â€¢ surveyYears: èª¿æŸ»å¹´æœˆ (ä¾‹: "2020", "202001-202012")
â€¢ limit: å–å¾—ä»¶æ•° (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ10, æœ€å¤§100000)

ã€æ¤œç´¢ã®ã‚³ãƒ„ã€‘
1. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã‹ã‚‰å§‹ã‚ã‚‹
2. çµ±è¨ˆã‚³ãƒ¼ãƒ‰ã§çµžã‚Šè¾¼ã‚€
3. èª¿æŸ»å¹´æœˆã§æœŸé–“ã‚’é™å®š
4. åœ°åŸŸåŒºåˆ†ã§å¯¾è±¡ã‚’æ˜Žç¢ºåŒ–

ã€å‡ºåŠ›ã€‘
â€¢ 20ä»¶ä»¥ä¸‹: MCPãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¡¨ç¤º
â€¢ 20ä»¶è¶…: è‡ªå‹•çš„ã«ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜

ã€ä½¿ç”¨ä¾‹ã€‘
å›½å‹¢èª¿æŸ»ã®äººå£é–¢é€£ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢:
{
  "searchWord": "äººå£",
  "statsCode": "00200521",
  "surveyYears": "2020",
  "limit": 20
}
    `;
  }

  getDataHelp() {
    return `
ðŸ“ˆ e_stat_get_data - çµ±è¨ˆãƒ‡ãƒ¼ã‚¿å–å¾—

ã€åŸºæœ¬çš„ãªä½¿ã„æ–¹ã€‘
æŒ‡å®šã—ãŸçµ±è¨ˆè¡¨IDã‹ã‚‰å®Ÿéš›ã®æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚

ã€å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ dataSetId: çµ±è¨ˆè¡¨ID (æ¤œç´¢ã§å–å¾—ã—ãŸID)

ã€çµžã‚Šè¾¼ã¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
ðŸŒ åœ°åŸŸäº‹é …:
â€¢ lvArea, cdArea, cdAreaFrom, cdAreaTo
  ä¾‹: "cdArea": "13000" (æ±äº¬éƒ½)

â° æ™‚é–“è»¸äº‹é …:
â€¢ lvTime, cdTime, cdTimeFrom, cdTimeTo
  ä¾‹: "cdTime": "2020000000" (2020å¹´)

ðŸ“Š è¡¨ç« äº‹é …:
â€¢ lvTab, cdTab, cdTabFrom, cdTabTo
  ä¾‹: "cdTab": "001" (äººå£æ•°)

ðŸ‘¥ åˆ†é¡žäº‹é …:
â€¢ lvCat01, cdCat01, lvCat02, cdCat02
  ä¾‹: "cdCat01": "001" (ç”·æ€§)

ã€åˆ¶å¾¡ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ limit: å–å¾—ä»¶æ•° (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ1000, æœ€å¤§10000)
â€¢ startPosition: é–‹å§‹ä½ç½®
â€¢ metaGetFlg: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾— ("Y"/"N")
â€¢ replaceSpChar: ç‰¹æ®Šæ–‡å­—ç½®æ› ("0"-"3")

ã€å‡ºåŠ›ã€‘
â€¢ 100ä»¶ä»¥ä¸‹: MCPãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¡¨ç¤º
â€¢ 100ä»¶è¶…: è‡ªå‹•çš„ã«ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜

ã€å®Ÿç”¨ä¾‹ã€‘
æ±äº¬éƒ½ã®2020å¹´ç”·æ€§äººå£:
{
  "dataSetId": "0003448237",
  "cdArea": "13000",
  "cdTime": "2020000000", 
  "cdCat01": "001",
  "limit": 100
}
    `;
  }

  getMetaHelp() {
    return `
ðŸ“ e_stat_get_meta - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—

ã€åŸºæœ¬çš„ãªä½¿ã„æ–¹ã€‘
çµ±è¨ˆè¡¨ã®æ§‹é€ ãƒ»é …ç›®å®šç¾©ãƒ»åˆ†é¡žæƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚
ãƒ‡ãƒ¼ã‚¿å–å¾—å‰ã«å¿…ãšç¢ºèªã™ã‚‹ã“ã¨ã‚’æŽ¨å¥¨ã—ã¾ã™ã€‚

ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ dataSetId: çµ±è¨ˆè¡¨ID (å¿…é ˆ)
â€¢ explanationGetFlg: è§£èª¬æƒ…å ±å–å¾— ("Y"/"N")

ã€å–å¾—ã§ãã‚‹æƒ…å ±ã€‘
ðŸ“‹ åŸºæœ¬æƒ…å ±:
â€¢ çµ±è¨ˆè¡¨ã‚¿ã‚¤ãƒˆãƒ«
â€¢ èª¿æŸ»å®Ÿæ–½æ©Ÿé–¢
â€¢ èª¿æŸ»å‘¨æœŸ
â€¢ èª¿æŸ»å¹´æœˆ

ðŸ—ï¸ ãƒ‡ãƒ¼ã‚¿æ§‹é€ :
â€¢ tab (è¡¨ç« äº‹é …): æ¸¬å®šé …ç›® (äººå£æ•°ã€ä¸–å¸¯æ•°ç­‰)
â€¢ area (åœ°åŸŸäº‹é …): åœ°åŸŸã‚³ãƒ¼ãƒ‰ (éƒ½é“åºœçœŒã€å¸‚åŒºç”ºæ‘)
â€¢ time (æ™‚é–“è»¸äº‹é …): èª¿æŸ»æ™‚ç‚¹
â€¢ cat01-15 (åˆ†é¡žäº‹é …): ãã®ä»–åˆ†é¡ž (æ€§åˆ¥ã€å¹´é½¢ç­‰)

ã€æ´»ç”¨æ–¹æ³•ã€‘
1. ãƒ‡ãƒ¼ã‚¿å–å¾—å‰ã®æ§‹é€ ç¢ºèª
2. çµžã‚Šè¾¼ã¿æ¡ä»¶ã®ç‰¹å®š
3. åˆ†é¡žã‚³ãƒ¼ãƒ‰ã®ç¢ºèª
4. ãƒ‡ãƒ¼ã‚¿ã®è§£é‡ˆãƒ»ç†è§£

ã€ä½¿ç”¨ä¾‹ã€‘
{
  "dataSetId": "0003448237",
  "explanationGetFlg": "Y"
}

ðŸ’¡ ãƒ’ãƒ³ãƒˆ:
ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã—ã¦ã‹ã‚‰é©åˆ‡ãªçµžã‚Šè¾¼ã¿æ¡ä»¶ã‚’
e_stat_get_dataã§æŒ‡å®šã—ã¦ãã ã•ã„ã€‚
    `;
  }

  getDownloadHelp() {
    return `
ðŸ’¾ e_stat_download - ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

ã€åŸºæœ¬çš„ãªä½¿ã„æ–¹ã€‘
çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã¾ã™ã€‚
å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®ä¸€æ‹¬å‡¦ç†ã«é©ã—ã¦ã„ã¾ã™ã€‚

ã€æ“ä½œãƒ¢ãƒ¼ãƒ‰ã€‘
â€¢ search_and_download: æ¤œç´¢ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
â€¢ download_data: ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆIDã‹ã‚‰ç›´æŽ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
â€¢ download_with_meta: ãƒ‡ãƒ¼ã‚¿+ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ operation: æ“ä½œãƒ¢ãƒ¼ãƒ‰
â€¢ outputPath: ä¿å­˜å…ˆãƒ‘ã‚¹ (å¿…é ˆ)
â€¢ format: ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ ("json"/"csv")
â€¢ searchWord: æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ (search_and_downloadæ™‚)
â€¢ dataSetId: çµ±è¨ˆè¡¨ID (downloadç³»æ“ä½œæ™‚)
â€¢ limit: å–å¾—ä»¶æ•°
â€¢ includeMetadata: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å«æœ‰ãƒ•ãƒ©ã‚°

ã€ä½¿ç”¨ä¾‹ã€‘

1) æ¤œç´¢ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰:
{
  "operation": "search_and_download",
  "searchWord": "äººå£æŽ¨è¨ˆ",
  "outputPath": "./downloads/population_search.json",
  "limit": 50
}

2) ãƒ‡ãƒ¼ã‚¿ã‚’ç›´æŽ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰:
{
  "operation": "download_data", 
  "dataSetId": "0003448237",
  "outputPath": "./downloads/population_data.csv",
  "format": "csv",
  "limit": 5000
}

3) ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä»˜ããƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰:
{
  "operation": "download_with_meta",
  "dataSetId": "0003448237", 
  "outputPath": "./downloads/full_data.json"
}

ðŸ’¡ æŽ¨å¥¨ç”¨é€”:
â€¢ å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
â€¢ å®šæœŸçš„ãªãƒ‡ãƒ¼ã‚¿åŽé›†
â€¢ CSVã§ã®å¤–éƒ¨ãƒ„ãƒ¼ãƒ«é€£æº
    `;
  }

  getDebugHelp() {
    return `
ðŸ”§ e_stat_debug - æŽ¥ç¶šãƒ»å‹•ä½œç¢ºèª

ã€åŸºæœ¬çš„ãªä½¿ã„æ–¹ã€‘
e-Stat APIã®æŽ¥ç¶šçŠ¶æ³ã‚„ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã‚’ç¢ºèªã—ã¾ã™ã€‚
å•é¡ŒãŒç™ºç”Ÿã—ãŸéš›ã®è¨ºæ–­ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

ã€ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ—ã€‘
â€¢ connection: åŸºæœ¬æŽ¥ç¶šãƒ†ã‚¹ãƒˆ
â€¢ minimal_search: æœ€å°é™ã®æ¤œç´¢ãƒ†ã‚¹ãƒˆ
â€¢ api_info: APIè¨­å®šæƒ…å ±è¡¨ç¤º

ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ testType: ãƒ†ã‚¹ãƒˆã®ç¨®é¡ž
â€¢ searchWord: æ¤œç´¢ãƒ†ã‚¹ãƒˆç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰

ã€ä½¿ç”¨ä¾‹ã€‘

1) åŸºæœ¬æŽ¥ç¶šç¢ºèª:
{
  "testType": "connection"
}

2) æ¤œç´¢å‹•ä½œç¢ºèª:
{
  "testType": "minimal_search",
  "searchWord": "äººå£"
}

3) APIè¨­å®šç¢ºèª:
{
  "testType": "api_info"
}

ã€ç¢ºèªé …ç›®ã€‘
âœ… APIã‚­ãƒ¼è¨­å®šçŠ¶æ³
âœ… ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æŽ¥ç¶š
âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼
âœ… ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è©³ç´°

ðŸ’¡ ãƒˆãƒ©ãƒ–ãƒ«æ™‚ã®ä½¿ç”¨æ‰‹é †:
1. connection ã§åŸºæœ¬æŽ¥ç¶šç¢ºèª
2. minimal_search ã§æœ€å°æ¤œç´¢ãƒ†ã‚¹ãƒˆ
3. api_info ã§è¨­å®šæƒ…å ±ç¢ºèª
4. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã—ã¦å¯¾å‡¦
    `;
  }

  getExamples() {
    return `
ðŸ’¡ å®Ÿç”¨çš„ãªä½¿ç”¨ä¾‹

ã€ä¾‹1: äººå£çµ±è¨ˆã®åˆ†æžã€‘
# ã‚¹ãƒ†ãƒƒãƒ—1: äººå£é–¢é€£çµ±è¨ˆã‚’æ¤œç´¢
e_stat_search {
  "searchWord": "äººå£æŽ¨è¨ˆ",
  "statsCode": "00200524",
  "limit": 10
}

# ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ç¢ºèª
e_stat_get_meta {
  "dataSetId": "å–å¾—ã—ãŸID"
}

# ã‚¹ãƒ†ãƒƒãƒ—3: éƒ½é“åºœçœŒåˆ¥ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
e_stat_get_data {
  "dataSetId": "å–å¾—ã—ãŸID",
  "lvArea": "2",         // éƒ½é“åºœçœŒãƒ¬ãƒ™ãƒ«
  "cdTime": "2020000000", // 2020å¹´
  "limit": 100
}

ã€ä¾‹2: çµŒæ¸ˆçµ±è¨ˆã®æ™‚ç³»åˆ—åˆ†æžã€‘
# GDPé–¢é€£ãƒ‡ãƒ¼ã‚¿ã®æ¤œç´¢
e_stat_search {
  "searchWord": "å›½å†…ç·ç”Ÿç”£",
  "surveyYears": "2015-2025",
  "limit": 20
}

# æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
e_stat_get_data {
  "dataSetId": "å–å¾—ã—ãŸID",
  "lvTime": "1-3",       // æ™‚ç³»åˆ—ã®è©³ç´°ãƒ¬ãƒ™ãƒ«
  "cdArea": "00000",     // å…¨å›½
  "limit": 200
}

ã€ä¾‹3: åœ°åŸŸåˆ¥åŠ´åƒçµ±è¨ˆã€‘
# åŠ´åƒåŠ›èª¿æŸ»ã®æ¤œç´¢
e_stat_search {
  "searchWord": "åŠ´åƒåŠ›èª¿æŸ»",
  "collectArea": "2",    // éƒ½é“åºœçœŒ
  "limit": 15
}

# é–¢æ±åœ°æ–¹ã®ãƒ‡ãƒ¼ã‚¿å–å¾—
e_stat_get_data {
  "dataSetId": "å–å¾—ã—ãŸID",
  "cdAreaFrom": "08000", // èŒ¨åŸŽçœŒã‹ã‚‰
  "cdAreaTo": "14000",   // ç¥žå¥ˆå·çœŒã¾ã§
  "cdCat01": "001",      // ç”·æ€§
  "limit": 500
}

ã€ä¾‹4: å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€‘
e_stat_download {
  "operation": "download_with_meta",
  "dataSetId": "0003448237",
  "outputPath": "./downloads/census_full_data.json",
  "limit": 10000,
  "includeMetadata": true
}

ðŸ’¡ åŠ¹çŽ‡çš„ãªåˆ†æžæ‰‹é †:
1. åºƒã„æ¤œç´¢ã‹ã‚‰å§‹ã‚ã¦å¯¾è±¡ã‚’çµžã‚Šè¾¼ã¿
2. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã§æ§‹é€ ã‚’ç†è§£
3. å°ã•ãªã‚µãƒ³ãƒ—ãƒ«ã§ãƒ†ã‚¹ãƒˆ
4. æœ¬æ ¼çš„ãªãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»åˆ†æž
    `;
  }

  getParameters() {
    return `
âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è©³ç´°ã‚¬ã‚¤ãƒ‰

ã€åœ°åŸŸäº‹é …ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ lvArea: éšŽå±¤ãƒ¬ãƒ™ãƒ«
  - "1": éƒ½é“åºœçœŒãƒ¬ãƒ™ãƒ«
  - "2": å¸‚åŒºç”ºæ‘ãƒ¬ãƒ™ãƒ«  
  - "1-2": ãƒ¬ãƒ™ãƒ«1ã‹ã‚‰2ã¾ã§
â€¢ cdArea: åœ°åŸŸã‚³ãƒ¼ãƒ‰
  - "13000": æ±äº¬éƒ½
  - "13101": åƒä»£ç”°åŒº
  - "00000": å…¨å›½
â€¢ cdAreaFrom/To: åœ°åŸŸã‚³ãƒ¼ãƒ‰ç¯„å›²

ã€æ™‚é–“è»¸äº‹é …ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ lvTime: æ™‚é–“éšŽå±¤ãƒ¬ãƒ™ãƒ«
â€¢ cdTime: æ™‚é–“ã‚³ãƒ¼ãƒ‰
  - "2020000000": 2020å¹´
  - "202001000000": 2020å¹´1æœˆ
â€¢ cdTimeFrom/To: æ™‚é–“ã‚³ãƒ¼ãƒ‰ç¯„å›²

ã€è¡¨ç« äº‹é …ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ lvTab: è¡¨ç« éšŽå±¤ãƒ¬ãƒ™ãƒ«
â€¢ cdTab: è¡¨ç« ã‚³ãƒ¼ãƒ‰
  - "001": äººå£æ•°
  - "002": ä¸–å¸¯æ•°
â€¢ cdTabFrom/To: è¡¨ç« ã‚³ãƒ¼ãƒ‰ç¯„å›²

ã€åˆ†é¡žäº‹é …ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
â€¢ lvCat01: åˆ†é¡ž1éšŽå±¤ãƒ¬ãƒ™ãƒ«
â€¢ cdCat01: åˆ†é¡ž1ã‚³ãƒ¼ãƒ‰
  - "001": ç”·æ€§
  - "002": å¥³æ€§
  - "003": ä¸è©³
â€¢ cdCat01From/To: åˆ†é¡ž1ã‚³ãƒ¼ãƒ‰ç¯„å›²

ã€æ”¿åºœçµ±è¨ˆã‚³ãƒ¼ãƒ‰ã€‘
â€¢ 00200521: å›½å‹¢èª¿æŸ»
â€¢ 00200524: äººå£æŽ¨è¨ˆ
â€¢ 00200531: åŠ´åƒåŠ›èª¿æŸ»
â€¢ 00200533: å®¶è¨ˆèª¿æŸ»
â€¢ 00200544: æ¶ˆè²»è€…ç‰©ä¾¡æŒ‡æ•°

ã€çµ±è¨ˆåˆ†é‡Žã‚³ãƒ¼ãƒ‰ã€‘
â€¢ 02: äººå£ãƒ»ä¸–å¸¯
â€¢ 03: åŠ´åƒãƒ»è³ƒé‡‘
â€¢ 04: å®¶è¨ˆãƒ»ç‰©ä¾¡
â€¢ 05: ä½å®…ãƒ»åœŸåœ°ãƒ»å»ºè¨­
â€¢ 07: ä¼æ¥­ãƒ»å®¶è¨ˆãƒ»çµŒæ¸ˆ
â€¢ 08: é‹è¼¸ãƒ»è¦³å…‰
â€¢ 09: æƒ…å ±é€šä¿¡ãƒ»ç§‘å­¦æŠ€è¡“
â€¢ 10: æ•™è‚²ãƒ»æ–‡åŒ–ãƒ»ã‚¹ãƒãƒ¼ãƒ„ãƒ»ç”Ÿæ´»
â€¢ 11: è¡Œè²¡æ”¿
â€¢ 12: å¸æ³•ãƒ»å®‰å…¨ãƒ»ç’°å¢ƒ

ã€æ—¥ä»˜å½¢å¼ã€‘
â€¢ yyyy: å¹´å˜ä½ (ä¾‹: "2020")
â€¢ yyyymm: æœˆå˜ä½ (ä¾‹: "202001")
â€¢ yyyymmdd: æ—¥å˜ä½ (ä¾‹: "20200101")
â€¢ ç¯„å›²æŒ‡å®š: "20200101-20201231"
    `;
  }

  getTroubleshooting() {
    return `
ðŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

ã€ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºç­–ã€‘

ðŸ”´ å•é¡Œ1: ã€Œçµ±è¨ˆè¡¨IDï¼ˆstatsDataIdï¼‰ã‚’æŒ‡å®šã—ã¦ä¸‹ã•ã„ã€
è§£æ±ºç­–: æ­£ã—ã„çµ±è¨ˆè¡¨IDã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„
â€¢ e_stat_search ã§æœ‰åŠ¹ãªIDã‚’å–å¾—
â€¢ IDã¯"0003448237"ã®ã‚ˆã†ãªå½¢å¼

ðŸ”´ å•é¡Œ2: ã€Œtimeout of 30000ms exceededã€
è§£æ±ºç­–: 
â€¢ limitå€¤ã‚’å°ã•ãã—ã¦å†è©¦è¡Œ
â€¢ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæŽ¥ç¶šã‚’ç¢ºèª
â€¢ e_stat_debug ã§æŽ¥ç¶šãƒ†ã‚¹ãƒˆ

ðŸ”´ å•é¡Œ3: ã€Œè©²å½“ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€
è§£æ±ºç­–:
â€¢ çµžã‚Šè¾¼ã¿æ¡ä»¶ã‚’ç·©å’Œ
â€¢ e_stat_get_meta ã§ãƒ‡ãƒ¼ã‚¿æ§‹é€ ç¢ºèª
â€¢ æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´

ðŸ”´ å•é¡Œ4: ãƒˆãƒ¼ã‚¯ãƒ³åˆ¶é™ã‚¨ãƒ©ãƒ¼
è§£æ±ºç­–: è‡ªå‹•è§£æ±ºæ¸ˆã¿
â€¢ å¤§é‡ãƒ‡ãƒ¼ã‚¿ã¯è‡ªå‹•çš„ã«ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
â€¢ outputPathãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®š

ðŸ”´ å•é¡Œ5: APIã‚­ãƒ¼ã‚¨ãƒ©ãƒ¼
è§£æ±ºç­–:
â€¢ src/config/api-keys.js ã®è¨­å®šç¢ºèª
â€¢ e-Stat APIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³IDå–å¾—
â€¢ e_stat_debug ã§è¨­å®šç¢ºèª

ã€ãƒ‡ãƒãƒƒã‚°æ‰‹é †ã€‘
1. e_stat_debug ã§åŸºæœ¬æŽ¥ç¶šç¢ºèª
2. ç°¡å˜ãªæ¤œç´¢ã§ãƒ†ã‚¹ãƒˆ
3. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã§æ§‹é€ ç¢ºèª
4. å°ã•ãªlimitå€¤ã‹ã‚‰é–‹å§‹
5. æ®µéšŽçš„ã«æ¡ä»¶ã‚’è¿½åŠ 

ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æ”¹å–„ã€‘
â€¢ é©åˆ‡ãªçµžã‚Šè¾¼ã¿æ¡ä»¶ã‚’ä½¿ç”¨
â€¢ ä¸è¦ãªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’é¿ã‘ã‚‹
â€¢ ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³æ´»ç”¨
â€¢ ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ã§å¤§é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†

ã€ã‚µãƒãƒ¼ãƒˆæƒ…å ±ã€‘
â€¢ e-Stat APIä»•æ§˜: https://www.e-stat.go.jp/api/
â€¢ æ”¿åºœçµ±è¨ˆã‚³ãƒ¼ãƒ‰ä¸€è¦§: æ¤œç´¢ç”»é¢ã§ç¢ºèª
â€¢ MCPä»•æ§˜: claude.ai/code

ðŸ’¡ ä¸æ˜Žãªç‚¹ãŒã‚ã‚Œã°:
1. e_stat_help ã§è©²å½“ãƒˆãƒ”ãƒƒã‚¯ç¢ºèª
2. e_stat_debug ã§å‹•ä½œç¢ºèª
3. å°ã•ãªã‚µãƒ³ãƒ—ãƒ«ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    `;
  }
}

const eStatHelpTool = new EStatHelpTool();
export const eStatHelpToolSchema = eStatHelpTool.getSchema();
export const eStatHelp = async (args) => await eStatHelpTool.execute(args);